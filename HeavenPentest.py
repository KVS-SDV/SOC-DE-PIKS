#!/usr/bin/env python3
#    ____   ___   ____   ____  _____   ____ ___ _  ______  
#                       HEAVEN
#       Chef de Projet : Ahmed
#       Script de Pentest Codé par Kavirajan SARAVANANE
#              Projet R&D SII
#                      © 
#
#
# HEAVEN version : 1.0
#
from termcolor import colored
from pyfiglet import Figlet
import sys, signal, os, socket, subprocess

def def_handler(sig, frame):
    print("\n\n[!] Going out...\n")
    sys.exit(1)

signal.signal(signal.SIGINT, def_handler)

def open_terminal_with_command(command):
    terminal_emulator = None
    if 'linux' in sys.platform:
        possible_terminal_emulators = ['gnome-terminal', 'konsole', 'xterm', 'xfce4-terminal', 'lxterminal']
        for emulator in possible_terminal_emulators:
            try:
                subprocess.Popen(['which', emulator], stdout=subprocess.PIPE, stderr=subprocess.PIPE).communicate()
                terminal_emulator = emulator
                break
            except FileNotFoundError:
                pass
    
    if terminal_emulator:
        subprocess.Popen([terminal_emulator, '-e', command])
    else:
        print("Unable to find a suitable terminal emulator.")

# menu d'accueil SOC de PIKS
print("\n")
f = Figlet(font='standard')
print(colored(f.renderText('    HEAVEN'), 'red', attrs=['blink', 'bold']))
print(colored('    Chef de Projet :', 'white'), colored('Ahmed EL-BERDHI', 'cyan'))
print(colored('    Script codé par :', 'white'), colored('Kavirajan SARAVANANE', 'cyan'))
print(colored('        Projet R&D', 'white'), colored(' © ', 'red'), colored('Groupe SII', 'green'))
print(colored('  Ne pas utiliser dans un environnement de production  ', 'yellow'))
print("\n")

while True:
    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    s.connect(("8.8.8.8", 80))
    print(colored('Votre adresse IP est: ', 'red'), s.getsockname()[0]+'\n')
    s.close()

    print("""Choisir une catégorie:
             1 - Attaque Normale
             2 - Fuzzer
             3 - Analysis
             4 - Backdoors
             5 - DOS (Denial of Service)
             6 - Exploits
             7 - Generic
             8 - Reconnaissance
             9 - ShellCode
            10 - Worms
            11 - Aide
            12 - Quitter
            """)
    option = input("Option: ")

    if option == "1":
        print("""Choisir un outil d'attaque Normale:
                1 - Metasploit FrameWork
                2 - Autre Outil
                3 - Quitter\n """)
        opt1 = input("Votre choix: ")

        if opt1 == "1":
            print("Metasploit FrameWork")
            cmd = os.system("apt install gnome-terminal > /dev/null 2>&1")
            open_terminal_with_command('msfconsole')
            input("Appuyez sur entrée pour continuer\n\n\n")
        elif opt1 == "2":
            cmd = os.system("apt install gnome-terminal > /dev/null 2>&1")
            custom_command = input("Entrez le nom d'un outil pour ouvrir avec un terminal: ")
            open_terminal_with_command(custom_command)
            input("Appuyez sur entrée pour continuer\n\n\n")
        elif opt1 == "3":
            print("Retour au menu principal.\n\n\n")
        else:
            print("Choix invalide. Veuillez entrer un numéro valide.\n\n\n")

    elif option == "2":
        print("""Choisir un outil de Fuzzing:
                1 - Peach Fuzzer
                2 - Ffuf
                3 - Quitter\n """)
        opt2 = input("Votre choix: ")

        if opt2 == "1":
            print("Peach Fuzzer")
            print("Installation de Peach Fuzzer en cours...")
            cmd = os.system("apt install peach > /dev/null 2>&1")
            print("Peach Fuzzer installé avec succès.")
    
            # Démarrage de Peach Fuzzer
            print("Démarrage de Peach Fuzzer...")
            cmd = os.system("peach")
    
            input("Appuyez sur entrée pour continuer\n\n\n")
        elif opt2 == "2":
            print("Ffuf")
            print("Installation de Ffuf en cours...")
            cmd = os.system("apt install ffuf > /dev/null 2>&1")
            print("Ffuf installé avec succès.")
    
            # Démarrage de Ffuf
            url = input("Saisir une URL à scanner: ")
            wordlist = input("Saisir le chemin vers le fichier de wordlist: ")
            print("Démarrage de Ffuf...")
            cmd = os.system(f"ffuf -u {url}/FUZZ -w {wordlist}")
    
            input("Appuyez sur entrée pour continuer\n\n\n")
        else:
            print("Retour au menu principal.\n\n\n")

    elif option == "3":
        print("""Choisir un outil d'Analysis:
                1 - Nmap
                2 - Nikto
                3 - WHOIS/NSLookup
                4 - Wireshark
                5 - Quitter\n """)
        opt3 = input("Votre choix: ")

        if opt3 == "1":
            print("""Choisir un outil:
                     1 - Scanner un réseau entier.
                     2 - Scanner les ports communs.
                     3 - Scanner les services.
                     4 - Scanner tous les ports.
                     5 - Scanner les ports TCP ouverts.
                     6 - Scanner les ports UDP ouverts.
                     7 - Effectuer un scan agressif.
                     8 - Quitter\n """)
            opt31 = input("Votre choix: ")

            if opt31 == "1":
                print("Scanner un réseau entier - NMAP")
                cmd = os.system("apt-get install nmap > /dev/null 2>&1")
                print("Entrez le réseau à scanner. Exemple: 192.168.1.0/24")
                ip = input("IP du réseau: ")
                cmd = os.system("nmap -sP %s " % ip)
                input("Appuyez sur entrée pour continuer\n\n\n")
            elif opt31 == "2":
                print("Scanner les ports - Mode rapide - NMAP")
                cmd = os.system("apt-get install nmap > /dev/null 2>&1")
                print("Entrez l'adresse IP à scanner. Exemple: 192.168.1.1")
                ip = input("Adresse IP: ")
                cmd = os.system("nmap -Pn -F %s " % ip)
                input("Appuyez sur entrée pour continuer\n\n\n")
            elif opt31 == "3":
                print("Scanner les services - NMAP")
                cmd = os.system("apt-get install nmap > /dev/null 2>&1")
                print("Entrez l'adresse IP à scanner. Exemple: 192.168.1.1")
                ip = input("Adresse IP: ")
                cmd = os.system("nmap -sV %s " % ip)
                input("Appuyez sur entrée pour continuer\n\n\n")
            elif opt31 == "4":
                print("Scanner tous les ports - NMAP")
                cmd = os.system("apt-get install nmap > /dev/null 2>&1")
                print("Entrez l'adresse IP à scanner. Exemple: 192.168.1.1")
                ip = input("Adresse IP: ")
                cmd = os.system("nmap -p- %s " % ip)
                input("Appuyez sur entrée pour continuer\n\n\n")
            elif opt31 == "5":
                print("Scanner les ports TCP ouverts - NMAP")
                cmd = os.system("apt-get install nmap > /dev/null 2>&1")
                print("Entrez l'adresse IP à scanner. Exemple: 192.168.1.1")
                ip = input("Adresse IP: ")
                cmd = os.system("nmap -sT %s " % ip)
                input("Appuyez sur entrée pour continuer\n\n\n")
            elif opt31 == "6":
                print("Scanner les ports UDP ouverts - NMAP")
                cmd = os.system("apt-get install nmap > /dev/null 2>&1")
                print("Entrez l'adresse IP à scanner. Exemple: 192.168.1.1")
                ip = input("Adresse IP: ")
                cmd = os.system("nmap -sU %s " % ip)
                input("Appuyez sur entrée pour continuer\n\n\n")
            elif opt31 == "7":


                print("Scan agressif - NMAP")
                cmd = os.system("apt-get install nmap > /dev/null 2>&1")
                print("Entrez l'adresse IP à scanner. Exemple: 192.168.1.1")
                ip = input("Adresse IP: ")
                cmd = os.system("nmap -A %s " % ip)
                input("Appuyez sur entrée pour continuer\n\n\n")
            elif opt31 == "8":
                print("Retour au menu principal.\n\n\n")
            else:
                print("Choix invalide. Veuillez entrer un numéro valide.\n\n\n")

        elif opt3 == "2":
            print("Nikto")
            cmd = os.system("apt-get install nikto > /dev/null 2>&1")
            print("Entrez l'adresse IP ou le nom d'hôte à scanner. Exemple: 192.168.1.1 ou www.example.com")
            host = input("Adresse IP ou Nom d'hôte: ")
            cmd = os.system("nikto -h %s " % host)
            input("Appuyez sur entrée pour continuer\n\n\n")
        elif opt3 == "3":
            print("""WHOIS/NSLookup
                1 - WHOIS
                2 - NSLookup
                3 - Quitter\n """)
            opt33 = input("Votre choix: ")

            if opt33 == "1":
                print("WHOIS")
                print("Entrez le nom de domaine à rechercher. Exemple: example.com")
                domain = input("Nom de domaine: ")
                cmd = os.system("whois %s " % domain)
                input("Appuyez sur entrée pour continuer\n\n\n")
            elif opt33 == "2":
                print("NSLookup")
                print("Entrez le nom de domaine à résoudre. Exemple: example.com")
                domain = input("Nom de domaine: ")
                cmd = os.system("nslookup %s " % domain)
                input("Appuyez sur entrée pour continuer\n\n\n")
            elif opt33 == "3":
                print("Retour au menu principal.\n\n\n")
            else:
                print("Choix invalide. Veuillez entrer un numéro valide.\n\n\n")

        elif opt3 == "4":
            print("Wireshark")
            cmd = os.system("apt-get install wireshark > /dev/null 2>&1")
            print("Lancement de Wireshark...")
            cmd = os.system("wireshark &")
            input("Appuyez sur entrée pour continuer\n\n\n")
        elif opt3 == "5":
            print("Retour au menu principal.\n\n\n")
        else:
            print("Choix invalide. Veuillez entrer un numéro valide.\n\n\n")

    elif option == "4":
        print("""Choisir un outil de Backdoors:
                1 - Metasploit FrameWork
                2 - Autre Outil
                3 - Quitter\n """)
        opt4 = input("Votre choix: ")

        if opt4 == "1":
            print("Metasploit FrameWork")
            cmd = os.system("apt install gnome-terminal > /dev/null 2>&1")
            open_terminal_with_command('msfconsole')
            input("Appuyez sur entrée pour continuer\n\n\n")
        elif opt4 == "2":
            cmd = os.system("apt install gnome-terminal > /dev/null 2>&1")
            custom_command = input("Entrez le nom d'un outil pour ouvrir avec un terminal: ")
            open_terminal_with_command(custom_command)
            input("Appuyez sur entrée pour continuer\n\n\n")
        elif opt4 == "3":
            print("Retour au menu principal.\n\n\n")
        else:
            print("Choix invalide. Veuillez entrer un numéro valide.\n\n\n")

    elif option == "5":
        print("""Choisir un outil de DOS (Denial of Service):
                1 - DDOS
                2 - Autre Outil
                3 - Quitter\n """)
        opt5 = input("Votre choix: ")

        if opt5 == "1":
            print("Votre choix est 6 - DDOS attack - Nmap - SlowLoris")
            print("DDOS attack démarre dans quelques secondes ..")
            cmd = os.system("apt install nmap > /dev/null 2>&1")
            ip = input("Saisir l'adresse IP à attaquer: ") 
            cmd = os.system("nmap %s -max-parallelism 800 -Pn --script http-slowloris --script-args http-slowloris.runforever=true " % ip)      
            input("Appuyez sur entrée pour continuer\n\n\n")
            # Retour au menu principal
        elif opt5 == "2":
            cmd = os.system("apt install gnome-terminal > /dev/null 2>&1")
            custom_command = input("Entrez le nom d'un outil pour ouvrir avec un terminal: ")
            open_terminal_with_command(custom_command)
            input("Appuyez sur entrée pour continuer\n\n\n")
        elif opt5 == "3":
            print("Retour au menu principal.\n\n\n")
        else:
            print("Choix invalide. Veuillez entrer un numéro valide.\n\n\n")

    elif option == "6":
        print("""Choisir un outil d'Exploitation:
                1 - Metasploit FrameWork
                2 - Autre Outil
                3 - Quitter\n """)
        opt6 = input("Votre choix: ")

        if opt6 == "1":
            print("Metasploit FrameWork")
            cmd = os.system("apt install gnome-terminal > /dev/null 2>&1")
            open_terminal_with_command('msfconsole')
            input("Appuyez sur entrée pour continuer\n\n\n")
        elif opt6 == "2":
            cmd = os.system("apt install gnome-terminal > /dev/null 2>&1")
            custom_command = input("Entrez le nom d'un outil pour ouvrir avec un terminal: ")
            open_terminal_with_command(custom_command)
            input("Appuyez sur entrée pour continuer\n\n\n")
        elif opt6 == "3":
            print("Retour au menu principal.\n\n\n")
        else:
            print("Choix invalide. Veuillez entrer un numéro valide.\n\n\n")

    elif option == "7":
        print("""Choisir un outil Générique:
                1 - Autre Outil
                2 - Quitter\n """)
        opt7 = input("Votre choix: ")

        if opt7 == "1":
            cmd = os.system("apt install gnome-terminal > /dev/null 2>&1")
            custom_command = input("Entrez le nom d'un outil pour ouvrir avec un terminal: ")
            open_terminal_with_command(custom_command)
            input("Appuyez sur entrée pour continuer\n\n\n")
        elif opt7 == "2":
            print("Retour au menu principal.\n\n\n")
        else:
            print("Choix invalide. Veuillez entrer un numéro valide.\n\n\n")

    elif option == "8":
        print("""Choisir un outil de Reconnaissance:
                1 - Metasploit FrameWork
                2 - Autre Outil
                3 - Quitter\n """)
        opt8 = input("Votre choix: ")

        if opt8 == "1":
            print("Metasploit FrameWork")
            cmd = os.system("apt install gnome-terminal > /dev/null 2>&1")
            open_terminal_with_command('msfconsole')
            input("Appuyez sur entrée pour continuer\n\n\n")
        elif opt8 == "2":
            cmd = os.system("apt install gnome-terminal > /dev/null 2>&1")
            custom_command = input("Entrez le nom d'un outil pour ouvrir avec un terminal: ")
            open_terminal_with_command(custom_command)
            input("Appuyez sur entrée pour continuer\n\n\n")
        elif opt8 == "3":
            print("Retour au menu principal.\n\n\n")
        else:
            print("Choix invalide. Veuillez entrer un numéro valide.\n\n\n")

    elif option == "9":
        print("""Choisir un outil ShellCode:
                1 - Metasploit FrameWork
                2 - Autre Outil
                3 - Quitter\n """)
        opt9 = input("Votre choix: ")

        if opt9 == "1":
            print("Metasploit FrameWork")
            cmd = os.system("apt install gnome-terminal > /dev/null 2>&1")
            open_terminal_with_command('msfconsole')
            input("Appuyez sur entrée pour continuer\n\n\n")
        elif opt9 == "2":
            cmd = os.system("apt install gnome-terminal > /dev/null 2>&1")
            custom_command = input("Entrez le nom d'un outil pour ouvrir avec un terminal: ")
            open_terminal_with_command(custom_command)
            input("Appuyez sur entrée pour continuer\n\n\n")
        elif opt9 == "3":
            print("Retour au menu principal.\n\n\n")
        else:
            print("Choix invalide. Veuillez entrer un numéro valide.\n\n\n")

    elif option == "10":
        print("""Choisir un outil Worms:
                1 - Metasploit FrameWork
                2 - Autre Outil
                3 - Quitter\n """)
        opt10 = input("Votre choix: ")

        if opt10 == "1":
            print("Metasploit FrameWork")
            cmd = os.system("apt install gnome-terminal > /dev/null 2>&1")
            open_terminal_with_command('msfconsole')
            input("Appuyez sur entrée pour continuer\n\n\n")
        elif opt10 == "2":
            cmd = os.system("apt install gnome-terminal > /dev/null 2>&1")
            custom_command = input("Entrez le nom d'un outil pour ouvrir avec un terminal: ")
            open_terminal_with_command(custom_command)
            input("Appuyez sur entrée pour continuer\n\n\n")
        elif opt10 == "3":
            print("Retour au menu principal.\n\n\n")
        else:
            print("Choix invalide. Veuillez entrer un numéro valide.\n\n\n")

    elif option == "11":
        print("Retour au menu principal.\n\n\n")

    elif option == "12":
        print("Au revoir.")
        break

    else:
        print("Choix invalide. Veuillez entrer un numéro valide.\n\n\n")